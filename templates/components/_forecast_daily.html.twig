{# Daily forecast component
  Usage examples:

  {% include 'components/_forecast_daily.html.twig' with {
    days: [
      { date: '2025-09-19', tmin: 12.3, tmax: 22.1, precip_mm: 0.0, weathercode: 3 },
      { date: '2025-09-20', tmin: 11.0, tmax: 20.4, precip_mm: 1.2, weathercode: 61 }
    ]
  } %}
#}

{# Daily forecast (7 days) — cards with icon + label + t° min/max + precip #}
<section class="card section-gap">
  <h2 class="h2">
    <svg class="icon" aria-hidden="true"><use href="#icon-cloud"/></svg>
    <span>Prévisions sur 7 jours</span>
  </h2>

  {% if days is not defined or days is empty %}
    <p class="muted">— en attente de résultats —</p>
  {% else %}
    <div class="grid grid-3" role="list" aria-label="Prévision journalière">
      {% for d in days %}
        {% set day_label = (d.date ?? '') ? d.date|format_date(locale='fr', pattern='EEE dd/MM') : '—' %}

        <article class="card" role="listitem" aria-label="Jour {{ day_label }}">
          <div class="small muted">{{ day_label }}</div>

          <div style="margin-top:8px; display:flex; align-items:center; justify-content:space-between; gap:12px;">
            <div>
              <div><strong>Max</strong> : {{ d.tmax is not null ? (d.tmax|number_format(1, '.', '')) ~ '°C' : '—' }}</div>
              <div><strong>Min</strong> : {{ d.tmin is not null ? (d.tmin|number_format(1, '.', '')) ~ '°C' : '—' }}</div>
            </div>

            {# Right column (precip + state). Show readable precip only when > 0; keep mm in tooltip #}
            {% set mm = (d.precip_mm is defined and d.precip_mm is not null) ? d.precip_mm : null %}
            {% set show_precip = (mm is not null and mm > 0) %}
            {% set title_mm = show_precip ? (mm|number_format(1, '.', '') ~ ' mm') : '' %}

            <div style="text-align:right">
              {# Show “Pluie : <label>” only when there is measurable rain #}
              {% if show_precip and d.precip_label is defined %}
                <div title="{{ title_mm }}">
                  <strong>Pluie</strong> : {{ d.precip_label }}
                </div>
              {% endif %}

              {# Weather icon + label (kept as visual+textual state) #}
              <div style="margin-top:6px; display:flex; align-items:center; gap:6px; justify-content:flex-end">
                <svg class="icon" style="width:22px;height:22px" aria-hidden="true">
                  <use href="#icon-{{ d.icon|default('na') }}"/>
                </svg>
                <span class="small muted">{{ d.label|default('—') }}</span>
              </div>
            </div>

          </div>
        </article>
      {% endfor %}
    </div>
  {% endif %}
</section>
